## Hi, decided to call the data set Food_Sec, have loaded the entire data set and would then subset it to the columns we are working on.
## There was one Raw_Data.csv file aswell that had done this already but that didn't have all the observations
getwd()

Food_Sec <-  data.frame(read.csv("dec21pub.csv"))

str(Food_Sec)
FS_Subset <- subset(Food_Sec, select = c("HRHHID",	"GTCO",	"GESTFIPS",	"HRNUMHOU",	"HEFAMINC",	"HESP1",	"PTDTRACE",	"PRCITSHP",	"PEMJNUM",	"PEHRUSL1",	"PEEDUCA", "HRFS12MD"))


## Installng tidyverse to use dplyr to rename the columns
install.packages('tidyverse')

```{r}
library(dplyr)
library(ezids)
head(FS_Subset)
```

FS_Subset <- FS_Subset %>% rename("Id" = "HRHHID", "Counties" = "GTCO", "States" = "GESTFIPS", "Family_Size" = "HRNUMHOU",	"Household_Income" = "HEFAMINC",	"SNAP" = "HESP1",	"Ethnicity" =	"PTDTRACE", "Citizenship_status" = "PRCITSHP",	"Number_of_Jobs" = "PEMJNUM",	"Hours_on_Jobs" = "PEHRUSL1" , "Education_Level" = "PEEDUCA" , "FoodSecurity_score" = "HRFS12MD")

```{r, results='markup'}
head(FS_Subset)
str(FS_Subset)

```



## Converting the all the columns to factors as they are all ordinal(except the Id, but since it's categorical i'm converting it into a factor too)

FS_Subset[] <- lapply( FS_Subset, factor)


str(FS_Subset)


##Exploring the Food Security Score

```{r, results='markup'}
summary(FS_Subset$'FoodSecurity_score')
```
## Installing ggplot, at then end we should just group all the library installation at the top

library(ggplot2)


ggplot(FS_Subset, aes(x=FoodSecurity_score, color =FoodSecurity_score, fill = FoodSecurity_score)) + geom_bar()

  
##1 :High Food Security, 2 : Marginal Food Security , 3 : Low Food Security, 4  : Very Low Food Security ,-9 : No Response
## Children’s Food Security Scale variables are coded as “Not in Universe” (-1) if there were no children in the household. 
## Attachment 17, on page 288, contains details about the food security score. I have only given it a cursory glace, but we will have to read it in detail.

## Exploring the Counties indice

```{r, results='markup'}
summary(FS_Subset$Counties)
```


## The first row is the county number, check the documentation to figure out the county, and the row just beneath it is the count. I'll have to check what county 0 means, i have a feeling it might mean that no county was reported in the survey.
##Also not all counties are represented in this data. There are 3143 counties in the US in total, in this dataset we have 100 counties( including the 0 county).




ggplot(FS_Subset, aes(x=Counties)) + geom_bar()



```{r}
food_fc <- subset(Food_Sec, HUFINAL == 001)
head(food_fc)
food_final <- subset(food_fc, select = c("HRHHID",	"GTCO",	"GESTFIPS",	"HRNUMHOU",	"HEFAMINC",	"HESP1",	"PTDTRACE",	"PRCITSHP",	"PEMJNUM",	"PEHRUSL1",	"PEEDUCA", "HRFS12MD"))
str(food_final)
```

```{r data_ave, results='markup'}
food_ave <- subset(food_final, select = c("HRHHID",	"PEMJNUM",	"PEHRUSL1",	"PEEDUCA", "HRFS12MD"))
head(food_ave)

#Now I rename the columns

colnames(food_ave) <- c("ID", "No_of_jobs","Hours_of_job","Edcation_Level","Food_Seurity_Score")
xkabledply(food_ave, title = "Data set")
```
